/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'application'
    id 'maven-publish'
    id "org.jetbrains.kotlin.jvm" version "1.3.72"
    id "idea"
}

apply plugin : "java"

ext {
    javaMainClass = "com.keithmackay.api.Main"
}

application {
    mainClassName = javaMainClass
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://arti.keithm.io/artifactory/mvn/')
    }
}

dependencies {
    compile 'com.google.guava:guava:23.0'
    compile 'org.jetbrains.kotlin:kotlin-reflect:1.3.50'
    compile 'org.eclipse.jetty:jetty-nosql:9.4.20.v20190813'
    compile 'com.google.code.gson:gson:2.8.6'
    compile 'org.mongodb:mongo-java-driver:3.11.0'
    compile 'org.jongo:jongo:1.4.0'
    compile 'commons-io:commons-io:2.6'
    compile 'org.mindrot:jbcrypt:0.4'
    compile 'khttp:khttp:1.0.0'
    compile 'com.sendgrid:sendgrid-java:4.4.1'
    compile 'org.apache.logging.log4j:log4j-api:2.14.0'
    compile 'org.apache.logging.log4j:log4j-core:2.14.0'
    compile 'org.apache.logging.log4j:log4j-slf4j-impl:2.14.0'
    compile 'org.aspectj:aspectjweaver:1.9.1'
    compile 'aopalliance:aopalliance:1.0'
    compile 'javax.xml.parsers:jaxp-api:1.4.5'
    compile 'com.sun.mail:javax.mail:1.6.2'
    compile 'com.google.inject:guice:4.2.2'
    compile 'com.google.inject.extensions:guice-assistedinject:4.2.2'
    compile 'org.jetbrains:annotations:13.0'
    compile 'io.javalin:javalin:3.9.0'
    compile 'io.micrometer:micrometer-core:1.2.0'
    compile 'org.mongodb:bson:3.11.0'
    compile 'org.dom4j:dom4j:2.1.1'
    compile 'com.nixxcode.jvmbrotli:jvmbrotli:0.2.0'
    compile 'org.quartz-scheduler:quartz:2.3.2'
    compile 'joda-time:joda-time:2.9.4'
    compile 'org.postgresql:postgresql:42.2.12'
    compile 'org.hibernate:hibernate-core:5.4.15.Final'
    compile 'org.twitter4j:twitter4j-core:4.0.7'
    compile 'io.keithm.domn8:DOMn8:1.0'
    testImplementation 'org.jetbrains.kotlin:kotlin-test-junit:1.3.50'
    testImplementation 'org.jetbrains.kotlin:kotlin-test-common:1.3.50'
    testImplementation 'org.jetbrains.kotlin:kotlin-test-annotations-common:1.3.50'

    compile group: 'com.squareup.okhttp3', name: 'okhttp', version: '4.7.2'

    compileOnly 'org.projectlombok:lombok:1.18.12'
    annotationProcessor 'org.projectlombok:lombok:1.18.12'

    testCompileOnly 'org.projectlombok:lombok:1.18.20'
    testAnnotationProcessor 'org.projectlombok:lombok:1.18.20'

    compile "org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.72"

    compile 'org.brotli:parent:0.1.2'
    compile 'org.meteogroup.jbrotli:jbrotli-native-linux-x86-amd64:0.5.0'
}

group = 'com.keithmackay.api'
version = '1.0.0'
sourceCompatibility = '11'

//create a single Jar with all dependencies
task makeJar(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Complete Jar',
                'Implementation-Version': archiveVersion,
                'Main-Class': 'com.keithmackay.api.Main'
    }
    archivesBaseName = project.name + '-all'
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

task getDeps(type: Copy) {
    from sourceSets.main.runtimeClasspath
    into 'runtime/'
}
